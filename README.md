# ms2Topo

**Topology-Driven MS2 Feature Extraction for DDA Mass Spectrometry**

ms2Topo is an MS2-centric framework for feature extraction and alignment in Data-Dependent Acquisition (DDA) mass spectrometry. Instead of defining features primarily through MS1 peak detection and later attaching MS2 spectra, ms2Topo inverts the logic:

> Fragmentation evidence defines feature identity.

Redundant MS2 spectra generated by DDA are treated as statistical replication rather than noise. A chemical feature is declared only if its fragmentation pattern forms a stable and coherent structure within a similarity network.

![[]](https://github.com/EdwinChingate/ms2Gauss/blob/main/ms2Topo.png)

---

## Core Principles

### 1. MS2-First Representation

Spectra are treated as structural fingerprints.
Intensity values are preprocessed to reduce sparsity effects and dominance of highly abundant fragments. Fragment presence, stability, and distribution are explicitly considered.

The goal is not to capture the strongest peaks â€” but the most reproducible structural evidence.

---

### 2. Topology-Driven Clustering

Instead of applying a fixed cosine similarity threshold, ms2Topo builds a similarity graph:

* **Nodes**: MS2 spectra
* **Edges**: spectral similarity
* **Communities**: topologically coherent feature modules

Clusters are evaluated using:

* Intra-cluster similarity distributions
* Contrast between internal coherence and nearest external similarity
* Weakest-link constraints to prevent chaining of structural isomers

Feature extraction becomes a **community detection problem under constraints**, not a thresholding exercise.

---

### 3. Consensus Under Uncertainty

Redundant spectra within a module are collapsed into a consensus spectrum.
Consensus construction accounts for:

* Fragment presence frequency
* Percentile-based m/z bounds
* Stability-aware intensity aggregation

The resulting features represent reproducible structural patterns rather than simple averages.

---

## What Makes ms2Topo Different?

* MS2 defines features, not just annotates them
* Feature identity emerges from network topology
* Intra-cluster distributions are explicitly modeled
* Structural coherence metrics are preserved in the feature table
* Alignment across samples is driven by fragmentation stability

ms2Topo is conceptually related to spectral networking approaches, but it uses consensus building as the feature detection step itself, integrating clustering geometry directly into feature declaration.

---

## Use Cases

* DDA metabolomics datasets
* Isomer discrimination
* Low-abundance metabolite detection
* Reproducibility-focused studies
* Structural stability benchmarking

---

## Current Status

ms2Topo is a research-grade framework under active development.
Ongoing improvements include scalable similarity computation, retention time normalization, and enhanced consensus modeling.

---

## Philosophy

Identity emerges from topology.

A feature exists only if its fragmentation pattern is reproducible, geometrically coherent, and statistically bounded.

Constraints drive the method.

